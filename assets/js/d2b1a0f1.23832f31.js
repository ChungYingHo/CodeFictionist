"use strict";(self.webpackChunkcode_fictionist=self.webpackChunkcode_fictionist||[]).push([[9354],{42297:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"tech_articles/dev-note/comprehensive_notes/package/handsontable_vue","title":"Handsontable - \u8868\u683c","description":"Handsontable \u5b98\u7db2","source":"@site/docs/tech_articles/06-dev-note/comprehensive_notes/04-package/02-handsontable_vue.mdx","sourceDirName":"tech_articles/06-dev-note/comprehensive_notes/04-package","slug":"/tech_articles/dev-note/comprehensive_notes/package/handsontable_vue","permalink":"/docs/tech_articles/dev-note/comprehensive_notes/package/handsontable_vue","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"vue3","permalink":"/docs/tags/vue-3"},{"inline":true,"label":"quasar","permalink":"/docs/tags/quasar"},{"inline":true,"label":"handsontable","permalink":"/docs/tags/handsontable"}],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Handsontable - \u8868\u683c","tags":["vue3","quasar","handsontable"]},"sidebar":"programSidebar","previous":{"title":"vue3-ol - \u4f86\u756b\u4e00\u5f35\u5730\u5716\u5427","permalink":"/docs/tech_articles/dev-note/comprehensive_notes/package/vue3-ol"},"next":{"title":"env-aligner - npm \u5957\u4ef6\u88fd\u4f5c","permalink":"/docs/tech_articles/dev-note/comprehensive_notes/package/env-aligner"}}');var r=t(74848),l=t(28453);const o={title:"Handsontable - \u8868\u683c",tags:["vue3","quasar","handsontable"]},s=void 0,i={},c=[{value:"\u5b89\u88dd",id:"\u5b89\u88dd",level:2},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:2},{value:"checkbox",id:"checkbox",level:2},{value:"Button (Custom Renderer)",id:"button-custom-renderer",level:2},{value:"Export to CSV",id:"export-to-csv",level:2},{value:"filter",id:"filter",level:2},{value:"\u5ba2\u88fd\u5404\u6b04\u4f4d\u7684 filter",id:"\u5ba2\u88fd\u5404\u6b04\u4f4d\u7684-filter",level:3},{value:"search",id:"search",level:3},{value:"\u81ea\u5b9a\u7fa9\u7279\u5b9a\u8cc7\u6599\u7be9\u9078",id:"\u81ea\u5b9a\u7fa9\u7279\u5b9a\u8cc7\u6599\u7be9\u9078",level:3},{value:"\u6e05\u9664\u7be9\u9078\u689d\u4ef6",id:"\u6e05\u9664\u7be9\u9078\u689d\u4ef6",level:3},{value:"\u986f\u793a\u9078\u4e2d\u7684\u8cc7\u6599",id:"\u986f\u793a\u9078\u4e2d\u7684\u8cc7\u6599",level:2},{value:"sort",id:"sort",level:2},{value:"\u65b0\u589e\u8cc7\u6599",id:"\u65b0\u589e\u8cc7\u6599",level:2},{value:"\u522a\u9664\u8207\u66f4\u65b0\u8cc7\u6599",id:"\u522a\u9664\u8207\u66f4\u65b0\u8cc7\u6599",level:2},{value:"\u5343\u5206\u4f4d\u986f\u793a",id:"\u5343\u5206\u4f4d\u986f\u793a",level:2},{value:"\u7ffb\u8b6f",id:"\u7ffb\u8b6f",level:2}];function d(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.admonition,{type:"info",children:(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://handsontable.com/",children:"Handsontable \u5b98\u7db2"})})}),"\n",(0,r.jsx)(e.p,{children:"Handsontable \u600e\u9ebc\u8aaa\u5462~ \u6309\u7167\u5b98\u7db2\u8aaa\u7684\uff1a"}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"JavaScript data grid with spreadsheet UI"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u6240\u4ee5\u5c31\u662f\u985e\u4f3c\u4e00\u500b\u53ef\u4ee5\u5728 Web \u4e0a\u4f7f\u7528\u7684 Excel \u8868\u683c\uff0c\u53ef\u4ee5\u9032\u884c\u7de8\u8f2f\u3001\u6392\u5e8f\u3001\u904e\u6ffe\u3001\u5408\u4f75\u5132\u5b58\u683c\u7b49\u7b49\u64cd\u4f5c\u3002",(0,r.jsx)(e.br,{}),"\n","\u56e0\u70ba\u5de5\u4f5c\u9700\u8981\uff0c\u6240\u4ee5\u82b1\u4e86\u6642\u9593\u505a\u4e86\u4e00\u4e9b\u7814\u7a76\uff0c\u5c31\u9806\u4fbf\u5beb\u4e00\u4e0b\u7b46\u8a18~"]}),"\n",(0,r.jsx)(e.admonition,{type:"info",children:(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.a,{href:"https://quasar-demo.vercel.app/demo-handsontable",children:"\u6211\u5beb\u7684 Handsontable Demo"}),"\u3002",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.a,{href:"https://github.com/ChungYingHo/Quasar-Template/commit/89ed5eacf359f141a4b5da912fb18862f61e7d97",children:"Demo code commit"}),"\n\u6b64 Demo \u4f7f\u7528 Vue3 (Quasar Framework)\uff0c\u8001\u5be6\u8aaa\u5982\u679c\u7528 React \u4f86\u5beb\u6703\u7c21\u55ae\u5f88\u591a\uff0c\u56e0\u70ba Handsontable \u5b98\u7db2\u76f4\u63a5\u6709\u63d0\u4f9b React \u7684\u7bc4\u4f8b\uff0cVue \u548c Angular \u5c31\u53ea\u6709\u6700\u57fa\u672c\u7684\u6559\u5b78\uff0c\u5176\u5b83\u90fd\u8981\u81ea\u5df1\u9b54\u6539\u3002"]})}),"\n",(0,r.jsx)(e.h2,{id:"\u5b89\u88dd",children:"\u5b89\u88dd"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-powershell",children:"npm install handsontable @handsontable/vue3\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:"<template>\n  <div>\n    <HotTable\n      ref=\"hotTable\"\n      col-widths=\"100px\"\n      row-heights=\"30px\"\n      license-key=\"non-commercial-and-evaluation\"\n      :data=\"data\"\n      :columns=\"columns\"\n      :col-headers=\"colHeaders\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { HotTable } from '@handsontable/vue3'\nimport { registerAllModules } from 'handsontable/registry'\nimport 'handsontable/dist/handsontable.full.css'\n\nconst data = [\n  { year: 2021, airport: 'Airport A' },\n  { year: 2022, airport: 'Airport B' },\n  { year: 2022, airport: 'Airport C' }\n]\n\nconst colHeaders = [\n  'Year',\n  'Airport'\n]\n\nconst columns = [\n  {\n    data: 'year'\n  },\n  {\n    data: 'airport',\n    readOnly: true\n  }\n]\n<\/script>\n"})}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"data"}),"\uff1a\u8868\u683c\u8cc7\u6599"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"columns"}),"\uff1a\u8868\u683c\u6b04\u4f4d"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"colHeaders"}),"\uff1a\u8868\u683c\u6b04\u4f4d\u540d\u7a31","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"readOnly"}),"\uff1a\u662f\u5426\u53ef\u7de8\u8f2f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"checkbox",children:"checkbox"}),"\n",(0,r.jsxs)(e.p,{children:["Handsontable \u672c\u8eab\u63d0\u4f9b checkbox \u7684 cell type\uff0c\u6211\u5011\u53ea\u9700\u8981\u8abf\u6574 ",(0,r.jsx)(e.code,{children:"columns"})," \u7684 ",(0,r.jsx)(e.code,{children:"type"})," \u5373\u53ef\u3002\u540c\u6642\u6211\u5011\u4e5f\u53ef\u4ee5\u7d66 ",(0,r.jsx)(e.code,{children:"data"})," \u4e00\u500b\u9810\u8a2d\u7684 boolean \u76f4\uff0c\u9019\u6a23\u521d\u6b21\u6e32\u67d3\u5c31\u53ef\u4ee5\u986f\u793a\u5404\u81ea\u7684 checkbox \u72c0\u614b\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const data = [\n  { year: 2021, airport: 'Airport A', isCheck: true },\n  { year: 2022, airport: 'Airport B', isCheck: false },\n  { year: 2022, airport: 'Airport C', isCheck: true }\n]\n\nconst colHeaders = [\n  'Year',\n  'Airport',\n  'Checkbox'\n]\n\nconst columns = [\n  {\n    data: 'year',\n    readOnly: true\n  },\n  {\n    data: 'airport',\n    readOnly: true\n  },\n  {\n    data: 'isCheck',\n    // highlight-next-line\n    type: 'checkbox'\n  }\n]\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"button-custom-renderer",children:"Button (Custom Renderer)"}),"\n",(0,r.jsxs)(e.p,{children:["Handsontable \u672c\u8eab\u6c92\u6709\u63d0\u4f9b button \u7684 cell type\uff0c\u4f46\u6211\u5011\u53ef\u4ee5\u900f\u904e ",(0,r.jsx)(e.code,{children:"renderer"})," \u4f86\u81ea\u5b9a\u7fa9\u4e00\u500b button\uff0c\u7136\u5f8c\u5c07\u81ea\u5b9a\u7fa9\u7684 ",(0,r.jsx)(e.code,{children:"renderer"})," \u653e\u5230 ",(0,r.jsx)(e.code,{children:"columns"})," \u7684 ",(0,r.jsx)(e.code,{children:"renderer"})," \u4e2d\u5373\u53ef\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const columns = [\n  {\n    data: 'year',\n    readOnly: true\n  },\n  {\n    data: 'airport',\n    readOnly: true\n  },\n  {\n    data: 'isCheck',\n    type: 'checkbox'\n  },\n  {\n    readOnly: true,\n    // highlight-next-line\n    renderer: createBtn\n  }\n]\n\n// \u81ea\u5b9a\u7fa9\u5275\u9020 button \u7684 function\uff0c\u88e1\u9762\u53ef\u4ee5\u5f88\u81ea\u7531\u5730\u5beb\u4e00\u4e9b\u908f\u8f2f\u5224\u65b7\uff0c\u50cf\u9019\u88e1\u5c31\u662f\u4f9d\u8cc7\u6599\u6709\u6c92\u6709\u5e36 url \u4f86\u6c7a\u5b9a button \u662f\u5426\u53ef\u9ede\u64ca\nfunction createBtn (instance: any, td: any, row: any) {\n  const rowData = instance.getSourceDataAtRow(row)\n  const link = rowData.url\n  if (link) {\n    td.innerHTML = '<button class=\"dialog-btn\"><i class=\"material-icons\">open_in_new</i></button>'\n  } else {\n    td.innerHTML = '<button class=\"dialog-btn\" disabled><i class=\"material-icons\">open_in_new</i></button>'\n  }\n  td.querySelector('.dialog-btn')?.addEventListener('click', () => {\n    if (link) {\n      openLink(link)\n    }\n  })\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"export-to-csv",children:"Export to CSV"}),"\n",(0,r.jsxs)(e.p,{children:["Handsontable \u672c\u8eab\u63d0\u4f9b\u4e86 ",(0,r.jsx)(e.code,{children:"exportFile"})," plugin\uff0c\u53ef\u4ee5\u5c07\u8868\u683c\u8cc7\u6599\u532f\u51fa\u6210 CSV \u6a94\u6848\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:"<template>\n  <div>\n    <HotTable\n      ref=\"hotTable\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nconst hotTable = ref<any>(null)\n\nconst exportToCsv = () => {\n  const hotInstance = hotTable.value.hotInstance\n  const exportPlugin = hotInstance.getPlugin('exportFile')\n  exportPlugin.downloadFile('csv', {\n    bom: false,  // \u662f\u5426\u52a0\u5165 BOM\n    columnDelimiter: ',', // \u6b04\u4f4d\u5206\u9694\u7b26\u865f\n    columnHeaders: true, // \u662f\u5426\u5305\u542b\u6b04\u4f4d\u540d\u7a31\n    exportHiddenColumns: true, // \u662f\u5426\u5305\u542b\u96b1\u85cf\u7684\u6b04\u4f4d\n    exportHiddenRows: true, // \u662f\u5426\u5305\u542b\u96b1\u85cf\u7684\u5217\n    fileExtension: 'csv', // \u6a94\u6848\u526f\u6a94\u540d\n    filename: 'PNR_DATA_[YYYY]-[MM]-[DD]', // \u6a94\u6848\u540d\u7a31\n    mimeType: 'text/csv', // \u6a94\u6848\u985e\u578b\n    rowDelimiter: '\\r\\n', // \u5217\u5206\u9694\u7b26\u865f\n    rowHeaders: true // \u662f\u5426\u5305\u542b\u5217\u540d\u7a31\n  })\n}\n<\/script>\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"filter",children:"filter"}),"\n",(0,r.jsx)(e.h3,{id:"\u5ba2\u88fd\u5404\u6b04\u4f4d\u7684-filter",children:"\u5ba2\u88fd\u5404\u6b04\u4f4d\u7684 filter"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<template>\n  <div>\n    <HotTable\n      ref="hotTable"\n      filters="true"\n      :dropdown-menu="dropdownMenu"\n      :settings="hotTableOptions"\n    />\n  </div>\n</template>\n\n<script setup lang="ts">\nconst hotTable = ref<any>(null)\n\n// filter_by_value \u548c filter_action_bar \u662f Handsontable \u63d0\u4f9b\u7684 filter \u9078\u9805\n// \u9019\u88e1\u7684 hidden \u662f\u7528\u4f86\u5224\u65b7\u662f\u5426\u8981\u986f\u793a\u8a72 filter \u9805\u76ee\nconst dropdownMenu = {\n  items: {\n    filter_by_value: {\n      hidden () {\n        const selectedCol = hotTable.value.hotInstance.getSelectedRangeLast()!.to.col\n        return selectedCol !== 0 && selectedCol !== 2\n      }\n    },\n    filter_action_bar: {\n      hidden () {\n        const selectedCol = hotTable.value.hotInstance.getSelectedRangeLast()!.to.col\n        return selectedCol !== 0 && selectedCol !== 2\n      }\n    }\n  }\n}\n\n\n// \u662f\u5426\u986f\u793a filter \u4e0b\u62c9\u9078\u55ae\u7684\u90a3\u9846\u6309\u9215\nconst hotTableOptions = {\n  afterGetColHeader: (col: number, TH: { querySelector: (arg0: string) => any; }) => {\n    if (col !== 0 && col !== 2) {\n      const button = TH.querySelector(\'.changeType\')\n      if (!button) {\n        return\n      }\n      button.parentElement.removeChild(button)\n    }\n  }\n}\n<\/script>\n'})}),"\n",(0,r.jsx)(e.h3,{id:"search",children:"search"}),"\n",(0,r.jsx)(e.p,{children:"\u53ef\u4ee5\u88fd\u505a\u4e00\u500b input \u4f86\u900f\u904e\u641c\u5c0b\u7be9\u9078\u8cc7\u6599\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<template>\n  <div>\n    <q-input\n      v-model="searchWord"\n      outlined\n      dense\n      label="Search"\n      placeholder="Search..."\n      class="q-mb-sm row"\n    />\n    <HotTable\n      ref="hotTable"\n      filters="true"\n      :dropdown-menu="dropdownMenu"\n      :settings="hotTableOptions"\n    />\n  </div>\n</template>\n\n<script setup lang="ts">\nconst hotTable = ref<any>(null)\nconst searchWord = ref(\'\')\n\nwatch(searchWord, (newVal) => {\n  if (hotTable.value) {\n    const filters = hotTable.value.hotInstance.getPlugin(\'filters\')\n    const columnToFilter = 0\n    filters.removeConditions(columnToFilter)\n    filters.addCondition(columnToFilter, \'contains\', [newVal])\n    filters.filter()\n  }\n})\n<\/script>\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u81ea\u5b9a\u7fa9\u7279\u5b9a\u8cc7\u6599\u7be9\u9078",children:"\u81ea\u5b9a\u7fa9\u7279\u5b9a\u8cc7\u6599\u7be9\u9078"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u81ea\u5b9a\u4e00\u9846\u6309\u9215\uff0c\u6309\u4e0b\u53bb\u5f8c\u53ef\u4ee5\u81ea\u52d5\u7be9\u51fa\u904e\u53bb\u5169\u5e74\u7684\u8cc7\u6599\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"// \u628a\u51fd\u5f0f\u7d81\u5230\u6309\u9215\u4e0a\u5373\u53ef\nconst filterPastTwoYears = () => {\n  if (hotTable.value) {\n    const filters = hotTable.value.hotInstance.getPlugin('filters')\n    const columnToFilter = 0\n    filters.removeConditions(columnToFilter)\n    filters.addCondition(columnToFilter, 'gte', [new Date().getFullYear() - 2])\n    filters.filter()\n  }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6e05\u9664\u7be9\u9078\u689d\u4ef6",children:"\u6e05\u9664\u7be9\u9078\u689d\u4ef6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const clearFilters = () => {\n  if (hotTable.value) {\n    const filters = hotTable.value.hotInstance.getPlugin('filters')\n    filters.clearConditions()\n    filters.filter()\n  }\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u986f\u793a\u9078\u4e2d\u7684\u8cc7\u6599",children:"\u986f\u793a\u9078\u4e2d\u7684\u8cc7\u6599"}),"\n",(0,r.jsxs)(e.p,{children:["Handsontable \u63d0\u4f9b ",(0,r.jsx)(e.code,{children:"afterSelectionEnd"})," hook\uff0c\u53ef\u4ee5\u8f09\u6211\u5011\u9078\u4e2d\u4e00\u500b cell \u6642\u914d\u5408 ",(0,r.jsx)(e.code,{children:"getDataAtRow"})," \u53d6\u5f97\u8a72\u5217\u7684\u8cc7\u6599\u3002",(0,r.jsx)(e.br,{}),"\n","\u53e6\u5916\uff0c\u56e0\u70ba checkbox \u5982\u679c\u662f\u900f\u904e\u9375\u76e4\u64cd\u4f5c\u7684\u8a71\uff0c\u7576 checkbox \u7684 boolean \u8b8a\u52d5\u6642 Handsontable \u4e26\u4e0d\u6703\u7acb\u5373\u66f4\u65b0\u986f\u793a\uff0c\u6240\u4ee5\u9019\u88e1\u9700\u8981\u900f\u904e ",(0,r.jsx)(e.code,{children:"afterChange"})," hook \u4f86\u76e3\u807d\u8cc7\u6599\u7684\u8b8a\u52d5\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const selectedData = ref<any>(null)\n\nwatch(() => hotTable.value, (newVal) => {\n  // afterChange \u662f\u7576\u8cc7\u6599\u6709\u8b8a\u52d5\u6642\u89f8\u767c\n  newVal.hotInstance.addHook('afterChange', (changes: any, source: any) => {\n    if (source === 'edit') {\n      const row = changes[0][0]\n      // remove the last column because it is a button\n      selectedData.value = newVal.hotInstance.getDataAtRow(row).slice(0, -1)\n    }\n  })\n\n  // afterSelectionEnd \u662f\u7576\u9078\u4e2d\u4e00\u5217\u6642\u89f8\u767c\n  if (newVal) {\n    newVal.hotInstance.addHook('afterSelectionEnd', (r: number) => {\n      // remove the last column because it is a button\n      selectedData.value = newVal.hotInstance.getDataAtRow(r).slice(0, -1)\n    })\n  }\n})\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"sort",children:"sort"}),"\n",(0,r.jsx)(e.admonition,{type:"danger",children:(0,r.jsxs)(e.p,{children:["Handsontable \u7684 ",(0,r.jsx)(e.code,{children:"column-sorting"})," \u50c5\u5c0d\u756b\u9762\u986f\u793a\u7684\u8cc7\u6599\u9032\u884c\u6392\u5e8f\uff0c\u4e0d\u6703\u5f71\u97ff\u5230 ",(0,r.jsx)(e.code,{children:"data"})," \u7684\u9806\u5e8f\u3002",(0,r.jsx)(e.br,{}),"\n","\u9019\u500b\u5f88\u91cd\u8981\uff0c\u6703\u5f71\u97ff\u5f8c\u7e8c\u522a\u9664\u3001\u66f4\u65b0\u8cc7\u6599\u7684\u908f\u8f2f\u5beb\u6cd5\u3002"]})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<template>\n  <div>\n    <HotTable\n      ref="hotTable"\n      // highlight-next-line\n      column-sorting=true\n    />\n  </div>\n</template>\n'})}),"\n",(0,r.jsxs)(e.admonition,{type:"tip",children:[(0,r.jsxs)(e.p,{children:["\u5728\u6709\u6392\u5e8f\u7684\u72c0\u6cc1\u4e0b\u82e5\u8981\u9032\u884c\u7b49\u7b49\u6703\u4ecb\u7d39\u7684",(0,r.jsx)(e.strong,{children:"\u65b0\u589e"}),"\u3001",(0,r.jsx)(e.strong,{children:"\u522a\u9664"}),"\u3001",(0,r.jsx)(e.strong,{children:"\u66f4\u65b0"}),"\u8cc7\u6599\uff0c\u9700\u8981\u5728\u64cd\u4f5c\u5b8c\u5f8c\u89f8\u767c\u6392\u5e8f\uff0c\u5426\u5247\u6703\u7522\u751f\u4e00\u4e9b\u975e\u9810\u671f\u7684\u7d50\u679c\u3002"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"nextTick(() => {\n  const hotInstance = hotTable.value.hotInstance\n  const columnSortingPlugin = hotInstance.getPlugin('columnSorting')\n  const sortSetting = columnSortingPlugin.getSortConfig()\n  columnSortingPlugin.sort(sortSetting)\n})\n"})})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u65b0\u589e\u8cc7\u6599",children:"\u65b0\u589e\u8cc7\u6599"}),"\n",(0,r.jsxs)(e.p,{children:["\u53ef\u4ee5\u900f\u904e\u57fa\u672c\u64cd\u4f5c\u9663\u5217\u7684\u65b9\u6cd5\u4f86\u65b0\u589e\u8cc7\u6599\uff0c\u8cc7\u6599\u5728 Handsontable \u986f\u793a\u7684\u9806\u5e8f\u6703\u8207\u5728 ",(0,r.jsx)(e.code,{children:"data"})," \u9663\u5217\u4e2d\u7684\u9806\u5e8f\u4e00\u81f4\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const data = ref<any>([\n  { year: 2021, airport: 'Airport A', price: 100000 },\n  { year: 2020, airport: 'Airport B', price: 200000 },\n  { year: 2019, airport: 'Airport C', price: 300000 }\n])\n\nconst addData = () => {\n  data.value.unshift({ year: 2019, airport: 'Airport add with unshift' })\n  data.value.push({ year: 2020, airport: 'Airport add with push' })\n  data.value.splice(2, 0, { year: 2018, airport: 'Airport add with splice' })\n\n  // trigger sorting immediately after adding data\n  nextTick(() => {\n    const hotInstance = hotTable.value.hotInstance\n    const columnSortingPlugin = hotInstance.getPlugin('columnSorting')\n    const sortSetting = columnSortingPlugin.getSortConfig()\n    columnSortingPlugin.sort(sortSetting)\n  })\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u522a\u9664\u8207\u66f4\u65b0\u8cc7\u6599",children:"\u522a\u9664\u8207\u66f4\u65b0\u8cc7\u6599"}),"\n",(0,r.jsxs)(e.p,{children:["\u9019\u88e1\u6211\u5011\u53ef\u4ee5\u70ba\u6bcf\u500b column \u589e\u52a0\u4e00\u500b delete button \u8ddf update button\uff0c\u900f\u904e\u9019\u5169\u500b button \u4f86\u9032\u884c\u522a\u9664\u8207\u66f4\u65b0\u8cc7\u6599\u3002",(0,r.jsx)(e.br,{}),"\n","\u65b9\u6cd5\u8ddf\u524d\u8ff0\u900f\u904e\u81ea\u5b9a\u7fa9 ",(0,r.jsx)(e.code,{children:"renderer"})," \u4f86\u589e\u52a0 button \u662f\u4e00\u6a23\u7684\uff0c\u53ea\u662f\u9019\u88e1\u7684\u908f\u8f2f\u6703\u6bd4\u8f03\u8907\u96dc\u4e00\u9ede\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u524d\u8ff0\u5728 ",(0,r.jsx)(e.code,{children:"sort"})," \u4e2d\u63d0\u5230\uff0c",(0,r.jsx)(e.code,{children:"column-sorting"})," \u53ea\u6703\u5f71\u97ff\u756b\u9762\u986f\u793a\u7684\u9806\u5e8f\uff0c\u6240\u4ee5\u756b\u9762\u986f\u793a\u7684\u9806\u5e8f\u8ddf ",(0,r.jsx)(e.code,{children:"data"})," \u9663\u5217\u7684\u9806\u5e8f\u662f\u4e0d\u4e00\u81f4\u7684\uff0c\u6240\u4ee5\u5728\u522a\u9664\u8207\u66f4\u65b0\u8cc7\u6599\u6642\uff0c\u9700\u8981\u5148\u627e\u5230\u9078\u4e2d\u7684\u8cc7\u6599\u5728 ",(0,r.jsx)(e.code,{children:"data"})," \u9663\u5217\u4e2d\u7684 index\uff0c\u7136\u5f8c\u518d\u9032\u884c\u522a\u9664\u6216\u66f4\u65b0\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"function createDeleteButton (instance: any, td: any, row: any) {\n  const btnClass = 'btn-delete'\n  const btnLabel = 'Delete'\n  const isDisabled = !canDelete.value\n  td.innerHTML = `<button class=\"${btnClass}\" ${isDisabled ? 'disabled' : ''}>${btnLabel}</button>`\n  td.querySelector(`.${btnClass}`)?.addEventListener('click', () => {\n    const instanceData = instance.getData()\n    const dataDeletedIndex = data.value.findIndex((item: { airport: string }) => item.airport === instanceData[row][1])\n    data.value.splice(dataDeletedIndex, 1)\n    nextTick(() => {\n      const columnSortingPlugin = instance.getPlugin('columnSorting')\n      const sortSetting = columnSortingPlugin.getSortConfig()\n      columnSortingPlugin.sort(sortSetting)\n    })\n  })\n}\n\nfunction createUpdateButton (instance: any, td: any, row: any) {\n  const btnClass = 'btn-update'\n  const btnLabel = 'Update'\n  const isDisabled = !canUpdate.value\n  td.innerHTML = `<button class=\"${btnClass}\" ${isDisabled ? 'disabled' : ''}>${btnLabel}</button>`\n  td.querySelector(`.${btnClass}`)?.addEventListener('click', () => {\n    const instanceData = instance.getData()\n    const dataUpdatedIndex = data.value.findIndex((item: { airport: string }) => item.airport === instanceData[row][1])\n    data.value[dataUpdatedIndex].year = 2019\n    data.value[dataUpdatedIndex].airport = `update row ${row} airport`\n    nextTick(() => {\n      const columnSortingPlugin = instance.getPlugin('columnSorting')\n      const sortSetting = columnSortingPlugin.getSortConfig()\n      columnSortingPlugin.sort(sortSetting)\n    })\n  })\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u5343\u5206\u4f4d\u986f\u793a",children:"\u5343\u5206\u4f4d\u986f\u793a"}),"\n",(0,r.jsxs)(e.p,{children:["\u82e5\u8981\u5728 cell \u7de8\u8f2f\u6642\u4e0d\u986f\u793a\u5343\u5206\u4f4d\uff0c\u4f46\u5728\u4e0d\u7de8\u8f2f\u6642\u986f\u793a\u5343\u5206\u4f4d\uff0c\u53ef\u4ee5\u5206\u5225\u64b0\u5beb ",(0,r.jsx)(e.code,{children:"editor"})," \u8207 ",(0,r.jsx)(e.code,{children:"renderer"}),"\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"class numberEditor extends Handsontable.editors.TextEditor {\n  // \u5efa\u7acb input \u6846\u5143\u7d20\uff0c\u9650\u5236\u53ea\u80fd\u8f38\u5165\u6578\u5b57\n  createElements () {\n    super.createElements()\n    this.TEXTAREA.setAttribute('type', 'text')\n    this.TEXTAREA.setAttribute('inputmode', 'numeric')\n  }\n\n  // \u7576\u7de8\u8f2f\u5668\u555f\u52d5\u6642\uff0c\u79fb\u9664\u5343\u5206\u4f4d\u986f\u793a\uff0c\u986f\u793a\u7d14\u6578\u5b57\n  setValue (value: any) {\n    const editNumber = value ? value.toString().replace(/,/g, '') : ''\n    super.setValue(editNumber)\n  }\n}\n\nconst columns = ref<any>([\n  {\n    data: 'year',\n    readOnly: true\n  },\n  {\n    data: 'airport',\n    readOnly: true\n  },\n  {\n    data: 'price',\n    type: 'numeric',\n    // highlight-start\n    renderer: thousandthPlaceRenderer,\n    editor: numberEditor\n    // highlight-end\n  },\n  {\n    readOnly: true,\n    renderer: createDeleteButton\n  },\n  {\n    readOnly: true,\n    renderer: createUpdateButton\n  }\n])\n\nfunction thousandthPlaceRenderer (instance: any, td: any, row: any, col: any, prop: any, value: any) {\n  td.innerHTML = value ? value.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',') : ''\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u7ffb\u8b6f",children:"\u7ffb\u8b6f"}),"\n",(0,r.jsx)(e.p,{children:"Handsobtable \u96d6\u7136\u63d0\u4f9b\u7ffb\u8b6f\uff0c\u4f46\u6211\u5011\u4ecd\u53ef\u4f7f\u7528 vue \u6700\u719f\u6089\u7684 vue-i18n \u4f86\u9032\u884c\u7ffb\u8b6f\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { useI18n } from 'vue-i18n'\nconst { t, locale } = useI18n()\n\nconst colHeaders = computed(() => [\n  t('handsontable.year'),\n  t('handsontable.airport'),\n  t('handsontable.price'),\n  t('handsontable.delete'),\n  t('handsontable.update')\n])\n\n// \u9019\u51fd\u5f0f\u662f\u7528\u4f86\u5207\u63db\u8a9e\u7cfb\u7684\nfunction switchLanguage () {\n  if (locale.value === 'en-US') {\n    locale.value = 'zh-TW'\n  } else {\n    locale.value = 'en-US'\n  }\n}\n"})})]})}function u(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>o,x:()=>s});var a=t(96540);const r={},l=a.createContext(r);function o(n){const e=a.useContext(l);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),a.createElement(l.Provider,{value:e},n.children)}}}]);