"use strict";(self.webpackChunkcode_fictionist=self.webpackChunkcode_fictionist||[]).push([[5684],{88151:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"tech_articles/framework/Vue/Quasar/quasar-axios","title":"Quasar - Axios","description":"\u9019\u4e00\u7bc7\u4e3b\u8981\u7d00\u9304\u5982\u4f55\u5728 Quasar \u4e2d\u4f7f\u7528 axios \u4f86 call API\uff0c\u6211\u521d\u6b21\u63a5\u89f8\u5230 Quasar \u6642\u662f\u5728\u5be6\u505a Quasar serverside pagination\uff0c\u9019\u662f\u7576\u521d\u525b\u5165\u8077\u6642\u6bcf\u500b\u524d\u7aef\u65b0\u4eba\u90fd\u8981\u505a\u7684\u5c0f\u5c08\u6848\uff0c\u7528\u4f86\u719f\u6089 Quasar \u8ddf\u5728 Quasar \u4e2d call API\u3002","source":"@site/docs/tech_articles/04-framework/02-Vue/Quasar/02-quasar-axios.mdx","sourceDirName":"tech_articles/04-framework/02-Vue/Quasar","slug":"/tech_articles/framework/Vue/Quasar/quasar-axios","permalink":"/docs/tech_articles/framework/Vue/Quasar/quasar-axios","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"quasar","permalink":"/docs/tags/quasar"},{"inline":true,"label":"vue","permalink":"/docs/tags/vue"},{"inline":true,"label":"axios","permalink":"/docs/tags/axios"}],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Quasar - Axios","tags":["quasar","vue","axios"]},"sidebar":"programSidebar","previous":{"title":"Quasar - \u5c08\u6848\u521d\u59cb\u5316","permalink":"/docs/tech_articles/framework/Vue/Quasar/quasar_init"},"next":{"title":"Docusaurus - \u5b89\u88dd\u8207\u8a2d\u5b9a","permalink":"/docs/tech_articles/framework/Docusaurus/install"}}');var a=r(74848),t=r(28453);const o={title:"Quasar - Axios",tags:["quasar","vue","axios"]},i=void 0,c={},l=[{value:"\u8a2d\u5b9a API",id:"\u8a2d\u5b9a-api",level:2},{value:"<code>/src/boot/axios.ts</code>",id:"srcbootaxiosts",level:3},{value:"<code>/src/service/index.ts</code>",id:"srcserviceindexts",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:3}];function u(e){const s={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:["\u9019\u4e00\u7bc7\u4e3b\u8981\u7d00\u9304\u5982\u4f55\u5728 Quasar \u4e2d\u4f7f\u7528 axios \u4f86 call API\uff0c\u6211\u521d\u6b21\u63a5\u89f8\u5230 Quasar \u6642\u662f\u5728\u5be6\u505a ",(0,a.jsx)(s.a,{href:"https://quasar.dev/vue-components/table#server-side-pagination-filter-and-sorting",children:"Quasar serverside pagination"}),"\uff0c\u9019\u662f\u7576\u521d\u525b\u5165\u8077\u6642\u6bcf\u500b\u524d\u7aef\u65b0\u4eba\u90fd\u8981\u505a\u7684\u5c0f\u5c08\u6848\uff0c\u7528\u4f86\u719f\u6089 Quasar \u8ddf\u5728 Quasar \u4e2d call API\u3002"]}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.a,{href:"https://quasar-demo.vercel.app/",children:"\u6211\u5beb\u7684 Quasar demo"}),"~",(0,a.jsx)(s.br,{}),"\n","\u672c\u6b21\u4f7f\u7528\u7684 API \u662f ",(0,a.jsx)(s.a,{href:"https://dummyjson.com/",children:"DummyJSON"}),"\u3002"]})}),"\n",(0,a.jsx)(s.h2,{id:"\u8a2d\u5b9a-api",children:"\u8a2d\u5b9a API"}),"\n",(0,a.jsx)(s.h3,{id:"srcbootaxiosts",children:(0,a.jsx)(s.code,{children:"/src/boot/axios.ts"})}),"\n",(0,a.jsxs)(s.p,{children:["\u5176\u5be6\u6211\u5011\u5728\u524d\u4e00\u7bc7\u6587\u7ae0\u5efa\u5b8c Quasar \u5c08\u6848\u5f8c\uff0c\u5982\u679c\u6709\u7a0d\u5fae\u901b\u901b\uff0c\u6703\u767c\u73fe Quasar \u5df2\u7d93\u5e6b\u5fd9\u5efa\u597d\u5f88\u591a\u9810\u8a2d\u7684\u8cc7\u6599\u593e\uff0c\u5176\u4e2d\u6709\u4e00\u500b ",(0,a.jsx)(s.code,{children:"/src/boot/axios.ts"}),"\uff0c\u9019\u662f Quasar \u4e2d\u8ca0\u8cac\u4f86\u628a axios \u7684\u5be6\u4f8b\u8a3b\u518a\u5230 Vue \u5168\u5c40\u7684\u8a2d\u5b9a\uff0c\u6240\u4ee5\u62ff\u5230\u65b0\u7684 API \u4e4b\u5f8c\u53ef\u4ee5\u4f86\u9019\u88e1\u505a\u8a2d\u5b9a\u3002"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",metastring:'title="src/boot/axios.ts"',children:"import axios, { AxiosInstance } from 'axios'\nimport { boot } from 'quasar/wrappers'\n\ndeclare module '@vue/runtime-core' {\n  interface ComponentCustomProperties {\n    $axios: AxiosInstance;\n    $api: AxiosInstance;\n  }\n}\n\n// Be careful when using SSR for cross-request state pollution\n// due to creating a Singleton instance here;\n// If any client changes this (global) instance, it might be a\n// good idea to move this instance creation inside of the\n// \"export default () => {}\" function below (which runs individually\n// for each client)\nconst api = axios.create({ baseURL: 'https://dummyjson.com/users' })\n\nexport default boot(({ app }) => {\n  // for use inside Vue files (Options API) through this.$axios and this.$api\n\n  app.config.globalProperties.$axios = axios\n  // ^ ^ ^ this will allow you to use this.$axios (for Vue Options API form)\n  //       so you won't necessarily have to import axios in each vue file\n\n  app.config.globalProperties.$api = api\n  // ^ ^ ^ this will allow you to use this.$api (for Vue Options API form)\n  //       so you can easily perform requests against your app's API\n})\n\nexport { api }\n"})}),"\n",(0,a.jsx)(s.h3,{id:"srcserviceindexts",children:(0,a.jsx)(s.code,{children:"/src/service/index.ts"})}),"\n",(0,a.jsxs)(s.p,{children:["\u63a5\u4e0b\u4f86\u6211\u5011\u53ef\u4ee5\u5728 ",(0,a.jsx)(s.code,{children:"/src"})," \u8def\u5f91\u4e0b\u5efa\u4e00\u500b ",(0,a.jsx)(s.code,{children:"service"})," \u8cc7\u6599\u593e\uff0c\u5728\u88e1\u9762\u653e\u6211\u5011\u7684 API \u4f7f\u7528\u908f\u8f2f\u3002"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",metastring:'title="src/service/index.ts"',children:"import { api } from 'src/boot/axios'\nimport { User, ApiParams } from 'src/components/models'\nimport { errorHandler } from 'src/composables/errorHandler'\n// NOTE only get user's firstName,lastName,age,gender,email,phone,id in this project\nconst buildUrl = (searchParams: ApiParams) => {\n  const { search, limit, skip, sortBy, order } = searchParams\n  const url = search ? '/search' : '/'\n  const params: {[key: string]: unknown} = {\n    select: 'firstName,lastName,age,gender,email,phone,id',\n    q: search ?? undefined,\n    limit: limit ?? undefined,\n    skip: skip ?? undefined,\n    sortBy: sortBy ?? undefined,\n    order: order ? 'desc' : 'asc'\n  }\n  return { url, params }\n}\n// get users\nexport const getUsers = async (searchParams: ApiParams) => {\n  try {\n    const { url, params } = buildUrl(searchParams)\n    const response = await api.get(url, { params })\n    const users = response.data.users\n    const total = response.data.total\n    return { users, total }\n  } catch (error) {\n    errorHandler(error)\n  }\n}\n// add user\nexport const addUser = async (user: User) => {\n  try {\n    const response = await api.post('/add', user)\n    return response.data\n  } catch (error) {\n    errorHandler(error)\n  }\n}\n// update user\nexport const updateUser = async (id: number, user: User) => {\n  try {\n    const response = await api.put(`/${id}`, user)\n    return response.data\n  } catch (error) {\n    errorHandler(error)\n  }\n}\n// delete user\nexport const deleteUser = async (id: number) => {\n  try {\n    const response = await api.delete(`/${id}`)\n    return response.data\n  } catch (error) {\n    errorHandler(error)\n  }\n}\n"})}),"\n",(0,a.jsx)(s.p,{children:"\u9019\u6a23\u4e4b\u5f8c\u5c31\u53ef\u4ee5\u5728\u6211\u5011\u7684 component \u4e2d\u4f7f\u7528\u9019\u4e9b API \u4e86\u3002"}),"\n",(0,a.jsx)(s.h3,{id:"\u4f7f\u7528",children:"\u4f7f\u7528"}),"\n",(0,a.jsx)(s.p,{children:"\u4e0a\u8ff0\u8a2d\u5b9a\u5b8c\u5f8c\uff0c\u53ef\u4ee5\u50cf\u9019\u6a23\u5728 component \u4e2d\u4f7f\u7528 API\u3002"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",metastring:'title="src/pages/QuasarTable.vue"',children:"import { getUsers } from 'src/service/api'\n\nonMounted(async () => {\n  try {\n    loading.value = true\n    // highlight-start\n    const params: ApiParams = {\n      limit: 5,\n      skip: 0\n    }\n    const response = await getUsers(params)\n    // highlight-end\n    const users = response?.users\n    const total = response?.total\n    rows.value = users\n    pagination.value.rowsNumber = total\n  } catch (error) {\n    errorHandler(error)\n  } finally {\n    loading.value = false\n  }\n})\n"})})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},28453:(e,s,r)=>{r.d(s,{R:()=>o,x:()=>i});var n=r(96540);const a={},t=n.createContext(a);function o(e){const s=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);